{"ast":null,"code":"import _classCallCheck from \"/html/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/html/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport moment from 'moment';\n\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar ExchangeInterface =\n/*#__PURE__*/\nfunction () {\n  function ExchangeInterface(onopen, onclose, notify) {\n    _classCallCheck(this, ExchangeInterface);\n\n    this.onopen = onopen;\n    this.onclose = onclose;\n    this.notify = notify;\n    this.pnl = {};\n    this.orderbook = {};\n    this.orderbook_updates = [];\n    this.trades = [];\n    this.orders = [];\n    this.hints = [];\n    this.websocket = null;\n  }\n\n  _createClass(ExchangeInterface, [{\n    key: \"render\",\n    value: function render() {\n      return null;\n    }\n  }, {\n    key: \"connect\",\n    value: function connect(host) {\n      var _this = this;\n\n      console.log(\"Opening connection to\", host);\n      this.websocket = new WebSocket(host);\n\n      this.websocket.onopen = function (event) {\n        console.log(\"WebSocket onopen\");\n\n        _this.onopen(event);\n      };\n\n      this.websocket.onclose = function (event) {\n        console.log(\"WebSocket onclose\");\n\n        _this.onclose(event);\n      };\n\n      this.websocket.onerror = function (event) {\n        console.log(\"WebSocket error\", event);\n      };\n\n      this.websocket.onmessage = function (event) {\n        console.log(\"WebSocket message\", event);\n        var data = JSON.parse(event.data);\n\n        switch (data.type) {\n          case 'orderbook':\n            console.log(\"Got orderbook\", data);\n\n            _this.handle_orderbook(data);\n\n            break;\n\n          case 'trade':\n            console.log(\"Got trade\", data);\n\n            _this.handle_trade(data);\n\n            break;\n\n          case 'order_ack':\n            console.log(\"Got order\", data);\n\n            _this.handle_order_ack(data);\n\n            break;\n\n          case 'cancel_ack':\n            console.log(\"Got cancel\", data);\n\n            _this.handle_cancel_ack(data);\n\n            break;\n\n          case 'hints':\n            console.log(\"Got hints\", data);\n\n            _this.handle_hints(data);\n\n            break;\n\n          case 'sync_state':\n            console.log(\"Got sync_state\", data);\n\n            _this.handle_sync_state(data);\n\n            break;\n\n          default:\n            console.error(\"Unsupported event\", data);\n            break;\n        }\n\n        _this.notify();\n      };\n    }\n  }, {\n    key: \"update_pnl\",\n    value: function update_pnl() {}\n  }, {\n    key: \"handle_orderbook\",\n    value: function handle_orderbook(data) {\n      this.orderbook = data;\n      this.orderbook.ask = this.orderbook.ask.reverse();\n      this.handle_orderbook_update(this.orderbook);\n    }\n  }, {\n    key: \"handle_orderbook_update\",\n    value: function handle_orderbook_update(data) {\n      var bid = null;\n      var ask = null;\n      var time = moment(data.time);\n\n      if (data.bid.length !== 0) {\n        bid = data.bid[0].price;\n      }\n\n      if (data.ask.length !== 0) {\n        ask = data.ask[data.ask.length - 1].price;\n      }\n\n      var tick = {\n        time: time,\n        bid: bid,\n        ask: ask\n      };\n      console.log(\"Updating orderbook history: \", tick);\n      this.orderbook_updates.push(tick);\n    }\n  }, {\n    key: \"handle_order_ack\",\n    value: function handle_order_ack(data) {\n      this.orders.push(data);\n    }\n  }, {\n    key: \"handle_cancel_ack\",\n    value: function handle_cancel_ack(data) {\n      for (var i = 0; i < this.orders.length; i++) {\n        if (this.orders[i].order_id === data.order_id) {\n          console.log(\"Removing order: \", this.orders[i]);\n          this.orders.splice(i, 1);\n          break;\n        }\n      }\n    }\n  }, {\n    key: \"handle_trade\",\n    value: function handle_trade(data) {\n      this.trades.unshift(data);\n\n      for (var i = 0; i < this.orders.length; i++) {\n        if (this.orders[i].order_id === data.order_id) {\n          this.orders[i].volume -= data.volume;\n\n          if (this.orders[i].volume <= 0) {\n            console.log(\"Removing order: \", this.orders[i]);\n            this.orders.splice(i, 1);\n          }\n\n          break;\n        }\n      }\n\n      this.update_pnl();\n    }\n  }, {\n    key: \"handle_hints\",\n    value: function handle_hints(data) {\n      console.log(\"Handling hints\");\n      this.hints = data.hints;\n    }\n  }, {\n    key: \"handle_sync_state\",\n    value: function handle_sync_state(data) {\n      console.log(\"Syncing state\");\n      this.handle_hints(data);\n\n      for (var i = 0; i < data.trades.length; i++) {\n        this.handle_trade(data.trades[i]);\n      }\n\n      for (var _i = 0; _i < data.orders.length; _i++) {\n        this.handle_order_ack(data.orders[_i]);\n      }\n\n      for (var _i2 = 0; _i2 < data.orderbooks.length; _i2++) {\n        this.handle_orderbook_update(data.orderbooks[_i2]);\n      }\n\n      this.handle_orderbook(data[\"orderbook\"]);\n    }\n  }, {\n    key: \"send\",\n    value: function send(data) {\n      this.websocket.send(JSON.stringify(data));\n    }\n  }, {\n    key: \"send_order\",\n    value: function send_order(side, price, volume, trader_id) {\n      var order = {\n        type: \"insert\",\n        trader_id: trader_id,\n        order_id: uuidv4(),\n        side: side,\n        price: price,\n        volume: volume\n      };\n      console.log(\"Sending order\", order);\n      this.send(order);\n    }\n  }, {\n    key: \"send_login\",\n    value: function send_login(trader_id) {\n      var message = {\n        type: \"login\",\n        trader_id: trader_id\n      };\n      console.log(\"Logging in with: \", trader_id);\n      this.send(message);\n    }\n  }, {\n    key: \"send_cancel\",\n    value: function send_cancel(order_id, trader_id) {\n      var cancel = {\n        type: \"cancel\",\n        trader_id: trader_id,\n        order_id: order_id\n      };\n      console.log(\"Sending cancel\", cancel);\n      this.send(cancel);\n    }\n  }, {\n    key: \"send_hint\",\n    value: function send_hint(hint, trader_id) {\n      var message = {\n        type: \"hint\",\n        hint: hint,\n        trader_id: trader_id\n      };\n      console.log(\"Sending hint\", message);\n      this.send(message);\n    }\n  }]);\n\n  return ExchangeInterface;\n}();\n\nexport default ExchangeInterface;","map":{"version":3,"sources":["/html/src/exchange_interface.js"],"names":["moment","uuidv4","replace","c","r","Math","random","v","toString","ExchangeInterface","onopen","onclose","notify","pnl","orderbook","orderbook_updates","trades","orders","hints","websocket","host","console","log","WebSocket","event","onerror","onmessage","data","JSON","parse","type","handle_orderbook","handle_trade","handle_order_ack","handle_cancel_ack","handle_hints","handle_sync_state","error","ask","reverse","handle_orderbook_update","bid","time","length","price","tick","push","i","order_id","splice","unshift","volume","update_pnl","orderbooks","send","stringify","side","trader_id","order","message","cancel","hint"],"mappings":"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","sourcesContent":["import moment from 'moment'\n\nfunction uuidv4(){\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n        var r = (Math.random() * 16 | 0), v = c === 'x' ? r : ((r & 0x3) | 0x8);\n\t\treturn v.toString(16);\n\t  });\n}\n\nclass ExchangeInterface {\n    constructor(\n        onopen, \n        onclose,\n        notify\n    ){\n        this.onopen = onopen;\n        this.onclose = onclose;\n        this.notify = notify\n\n        this.pnl = {}\n        this.orderbook = {}\n        this.orderbook_updates = []\n        this.trades = []\n        this.orders = []\n        this.hints = []\n\n        this.websocket = null;\n    }\n\n    render(){\n        return null;\n    }\n\n    connect(host){\n        console.log(\"Opening connection to\", host)\n        this.websocket = new WebSocket(host)\n        this.websocket.onopen = (event) => {\n            console.log(\"WebSocket onopen\")\n            this.onopen(event)\n        }\n        this.websocket.onclose = (event) => {\n            console.log(\"WebSocket onclose\")\n            this.onclose(event)\n        }\n        this.websocket.onerror = (event) => {\n            console.log(\"WebSocket error\", event)\n        }\n        this.websocket.onmessage = (event) => {\n            console.log(\"WebSocket message\", event)\n            let data = JSON.parse(event.data)\n\n            switch (data.type) {\n                case 'orderbook':\n                    console.log(\"Got orderbook\", data)\n                    this.handle_orderbook(data)\n                    break;\n                case 'trade':\n                    console.log(\"Got trade\", data)\n                    this.handle_trade(data)\n                    break;\n                case 'order_ack':\n                    console.log(\"Got order\", data)\n                    this.handle_order_ack(data)\n                    break;\n                case 'cancel_ack':\n                    console.log(\"Got cancel\", data)\n                    this.handle_cancel_ack(data)\n                    break;\n                case 'hints':\n                    console.log(\"Got hints\", data)\n                    this.handle_hints(data)\n                    break;\n                case 'sync_state':\n                    console.log(\"Got sync_state\", data)\n                    this.handle_sync_state(data)\n                    break;\n\n                default:\n                    console.error(\"Unsupported event\", data)\n                    break;\n            }\n\n            this.notify();\n        }\n    }\n\n    update_pnl(){\n\n    }\n\n    handle_orderbook(data){\n        this.orderbook = data\n        this.orderbook.ask = this.orderbook.ask.reverse()\n        this.handle_orderbook_update(this.orderbook)\n    }\n\n    handle_orderbook_update(data){\n        let bid = null\n        let ask = null\n        let time = moment(data.time)\n\n        if (data.bid.length !== 0){\n            bid = data.bid[0].price\n        }\n\n        if (data.ask.length !== 0){\n            ask = data.ask[data.ask.length - 1].price\n        }\n        const tick = {time: time, bid: bid, ask: ask}\n        console.log(\"Updating orderbook history: \", tick)\n\n        this.orderbook_updates.push(tick)\n    }\n\n    handle_order_ack(data){\n        this.orders.push(data);\n    }\n\n    handle_cancel_ack(data){\n        for (let i = 0; i < this.orders.length; i++){\n            if (this.orders[i].order_id === data.order_id)\n            {\n                console.log(\"Removing order: \", this.orders[i])\n                this.orders.splice(i, 1)\n                break\n            }\n        }\n    }\n\n    handle_trade(data){\n        this.trades.unshift(data);\n        for (let i = 0; i < this.orders.length; i++){\n            if (this.orders[i].order_id === data.order_id)\n            {\n                this.orders[i].volume -= data.volume\n                if (this.orders[i].volume <= 0){\n                    console.log(\"Removing order: \", this.orders[i])\n                    this.orders.splice(i, 1)\n                }\n                break\n            }\n        }\n        this.update_pnl()\n    }\n\n    handle_hints(data){\n        console.log(\"Handling hints\")\n        this.hints = data.hints\n    }\n\n    handle_sync_state(data){\n        console.log(\"Syncing state\")\n        this.handle_hints(data)\n\n        for (let i = 0; i < data.trades.length; i++)\n        {\n            this.handle_trade(data.trades[i])\n        }\n\n        for (let i = 0; i < data.orders.length; i++)\n        {\n            this.handle_order_ack(data.orders[i])\n        }\n\n        for (let i = 0; i < data.orderbooks.length; i++)\n        {\n            this.handle_orderbook_update(data.orderbooks[i])\n        }\n\n        this.handle_orderbook(data[\"orderbook\"])\n    }\n\n    send(data){\n        this.websocket.send(JSON.stringify(data));\n    }\n\n    send_order(side, price, volume, trader_id){\n        let order = {\n            type:\"insert\", \n            trader_id: trader_id,\n            order_id: uuidv4(),\n            side: side,\n            price: price,\n            volume: volume\n        }\n\n        console.log(\"Sending order\", order);\n        this.send(order);\n    }\n\n    send_login(trader_id){\n        let message = {\n            type: \"login\",\n            trader_id: trader_id\n        }\n\n        console.log(\"Logging in with: \", trader_id);\n        this.send(message);\n    }\n\n    send_cancel(order_id, trader_id){\n        let cancel = {\n\t\t\ttype:\"cancel\",\n\t\t\ttrader_id: trader_id, \n            order_id: order_id\n        }\n\n        console.log(\"Sending cancel\", cancel);\n        this.send(cancel)\n    }\n\n    send_hint(hint, trader_id){\n        let message = {\n            type:\"hint\",\n            hint: hint,\n\t\t\ttrader_id: trader_id\n        }\n\n        console.log(\"Sending hint\", message);\n        this.send(message)\n    }\n}\n\nexport default ExchangeInterface\n"]},"metadata":{},"sourceType":"module"}