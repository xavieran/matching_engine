{"ast":null,"code":"import _classCallCheck from \"/html/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/html/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport React from 'react';\n\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar ExchangeInterface =\n/*#__PURE__*/\nfunction () {\n  function ExchangeInterface(onopen, onclose) {\n    _classCallCheck(this, ExchangeInterface);\n\n    this.onopen = onopen;\n    this.onclose = onclose;\n    this.websocket = null;\n  }\n\n  _createClass(ExchangeInterface, [{\n    key: \"render\",\n    value: function render() {\n      return null;\n    }\n  }, {\n    key: \"connect\",\n    value: function connect(host) {\n      var _this = this;\n\n      console.log(\"Opening connection to\", host);\n      this.websocket = new WebSocket(host);\n\n      this.websocket.onopen = function (event) {\n        console.log(\"WebSocket onopen\");\n\n        _this.onopen(event);\n      };\n\n      this.websocket.onclose = function (event) {\n        console.log(\"WebSocket onclose\");\n\n        _this.onclose(event);\n      };\n\n      this.websocket.onerror = function (event) {\n        console.log(\"WebSocket error\");\n      };\n\n      this.websocket.onmessage = function (event) {\n        console.log(\"WebSocket error\");\n        data = JSON.parse(event.data);\n\n        switch (data.type) {\n          case 'orderbook':\n            console.log(\"Got orderbook\", data);\n            break;\n\n          case 'trade':\n            console.log(\"Got trade\", data);\n            break;\n\n          case 'order':\n            console.log(\"Got order\", data);\n            break;\n\n          default:\n            console.error(\"Unsupported event\", data);\n            break;\n        }\n      };\n    }\n  }, {\n    key: \"send\",\n    value: function send(data) {\n      this.state.websocket.send(JSON.stringify(data));\n    }\n  }, {\n    key: \"send_order\",\n    value: function send_order(side, price, volume, trader_id) {\n      var order = {\n        type: \"insert\",\n        trader_id: trader_id,\n        order_id: uuidv4(),\n        side: side,\n        price: price,\n        volume: volume\n      };\n      console.log(\"Sending order\", order);\n      this.send(order);\n    }\n  }, {\n    key: \"register_trader\",\n    value: function register_trader(trader_id) {\n      var message = {\n        type: \"sync_state\",\n        trader_id: trader_id\n      };\n      console.log(\"Sending trader_id\", trader_id);\n      this.send(message);\n    }\n  }, {\n    key: \"send_cancel\",\n    value: function send_cancel(order_id, trader_id) {\n      var cancel = {\n        type: \"cancel\",\n        trader_id: trader_id,\n        order_id: order_id\n      };\n      console.log(\"Sending cancel\", cancel);\n      this.send(cancel);\n    }\n  }]);\n\n  return ExchangeInterface;\n}();\n\nexport default ExchangeInterface;","map":{"version":3,"sources":["/html/src/exchange_interface.js"],"names":["React","uuidv4","replace","c","r","Math","random","v","toString","ExchangeInterface","onopen","onclose","websocket","host","console","log","WebSocket","event","onerror","onmessage","data","JSON","parse","type","error","state","send","stringify","side","price","volume","trader_id","order","order_id","message","cancel"],"mappings":"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","sourcesContent":["import React from 'react';\n\nfunction uuidv4(){\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n        var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n\t\treturn v.toString(16);\n\t  });\n}\n\nclass ExchangeInterface {\n    constructor(\n        onopen, \n        onclose\n    ){\n        this.onopen = onopen;\n        this.onclose = onclose;\n        this.websocket = null;\n    }\n\n    render(){\n        return null;\n    }\n\n    connect(host){\n        console.log(\"Opening connection to\", host)\n        this.websocket = new WebSocket(host)\n        this.websocket.onopen = (event) => {\n            console.log(\"WebSocket onopen\")\n            this.onopen(event)\n        }\n        this.websocket.onclose = (event) => {\n            console.log(\"WebSocket onclose\")\n            this.onclose(event)\n        }\n        this.websocket.onerror = (event) => {\n            console.log(\"WebSocket error\")\n        }\n        this.websocket.onmessage = (event) => {\n            console.log(\"WebSocket error\")\n            data = JSON.parse(event.data)\n\n            switch (data.type) {\n                case 'orderbook':\n                    console.log(\"Got orderbook\", data)\n                    break;\n                case 'trade':\n                    console.log(\"Got trade\", data)\n                    break;\n                case 'order':\n                    console.log(\"Got order\", data)\n                    break;\n                default:\n                    console.error(\"Unsupported event\", data)\n                    break;\n            }\n        }\n    }\n\n    send(data){\n        this.state.websocket.send(JSON.stringify(data));\n    }\n\n    send_order(side, price, volume, trader_id){\n        let order = {\n            type:\"insert\", \n            trader_id: trader_id,\n            order_id: uuidv4(),\n            side: side,\n            price: price,\n            volume: volume}\n        console.log(\"Sending order\", order);\n        this.send(order);\n    }\n\n    register_trader(trader_id){\n        let message = {\n            type: \"sync_state\",\n            trader_id: trader_id\n        }\n\n        console.log(\"Sending trader_id\", trader_id);\n        this.send(message);\n    }\n\n    send_cancel(order_id, trader_id){\n        let cancel = {\n\t\t\ttype:\"cancel\",\n\t\t\ttrader_id: trader_id, \n            order_id: order_id}\n        console.log(\"Sending cancel\", cancel);\n        this.send(cancel)\n    }\n}\n\nexport default ExchangeInterface\n"]},"metadata":{},"sourceType":"module"}